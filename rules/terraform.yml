Rules:
  - id: R1
    message: Instance type should be t2.micro or m3.medium
    resource: aws_instance
    filters:
      - type: value
        key: instance_type
        op: in
        value: t2.micro,m3.medium
    severity: WARNING
  - id: R2
    message: Not an approved AMI
    resource: aws_instance
    filters:
      - type: value
        key: ami
        op: in
        value: ami-f2d3638a
    severity: FAILURE
  - id: R3
    message: Department tag is recommended
    resource: aws_instance
    filters:
      - type: value
        key: "tags[].Department | [0]"
        op: regex
        value: Operations
    severity: WARNING
  - id: R4
    message: Role name should start with 'role'
    resource: aws_iam_role
    filters:
      - type: value
        key: name
        op: regex
        value: "role*"
    severity: WARNING
  - id: R5
    message: Bucket name should end with ".com"
    resource: aws_s3_bucket
    filters:
      - type: value
        key: bucket
        op: regex
        value: ".com$"
    severity: WARNING
