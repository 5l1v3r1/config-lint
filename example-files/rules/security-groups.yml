version: 1
description: Rules for Security Groups
type: SecurityGroup
rules:
  - id: SG1
    message: Should not allow access to SSH from anywhere
    resource: "AWS::EC2::SecurityGroup"
    assertions:
      - not:
          - key: IpPermissions[?(FromPort==`22`)].IpRanges[].CidrIp | [0]
            op: eq
            value: "0.0.0.0/0"
    severity: NON_COMPLIANT
